FROM node:24-alpine

WORKDIR /app

COPY package*.json ./

RUN npm install --legacy-peer-deps

COPY . .

ARG MONGODB_URI
ARG NEXTAUTH_URL
ARG NEXTAUTH_SECRET

ENV MONGODB_URI=$MONGODB_URI
ENV NEXTAUTH_URL=$NEXTAUTH_URL
ENV NEXTAUTH_SECRET=$NEXTAUTH_SECRET

RUN npm run build

EXPOSE 3000

CMD ["npm", "start"]